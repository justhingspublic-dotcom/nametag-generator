# 名牌產生器 PRD (Product Requirements Document)

> **版本**：1.0
> **建立日期**：2026-01-21
> **專案代號**：NameTag Generator

---

## 1. 產品概述

### 1.1 產品願景
打造一款「全可編輯」的智慧名牌產生器網頁應用，讓使用者能快速匯入名單、自訂版型、微調個別名牌，並輸出專業品質的名牌文件。

### 1.2 目標使用者
- 活動主辦單位
- 旅行社領隊
- 企業 HR / 行政人員
- 會議、研討會籌辦人員

### 1.3 核心價值
- **零程式碼編輯**：所有文字、樣式皆可透過 UI 直接修改
- **智慧預設 + 彈性覆寫**：系統自動判斷（如素食桌、分車），但使用者隨時可手動調整
- **即時預覽**：所有變更立即反映在預覽畫面
- **多格式輸出**：支援 PDF、Word、直接列印

---

## 2. 設計風格

### 2.1 視覺主題
| 項目 | 規格 |
|------|------|
| 整體風格 | 簡約未來感、AI 科技風 |
| 配色基調 | **深色主題** (類似 Typora 深色模式) |
| 主背景色 | `#1a1a2e` ~ `#16213e` (深藍黑) |
| 次背景色 | `#0f3460` (區塊底色) |
| 強調色 | `#00d9ff` (科技青) / `#7c3aed` (未來紫) |
| 文字色 | `#e4e4e7` (主文字) / `#a1a1aa` (次要文字) |
| 字型 | `Inter`, `Noto Sans TC`, `monospace` |

### 2.2 UI 元素特徵
- 圓角卡片式佈局 (border-radius: 12px)
- 微光 (glow) 效果強調互動元素
- 毛玻璃效果 (backdrop-filter: blur)
- 平滑過渡動畫 (transition: 0.3s ease)
- 細線邊框 (`1px solid rgba(255,255,255,0.1)`)

---

## 3. 功能需求

### 3.1 第一區：資料匯入與預處理 (Data Source)

#### 3.1.1 檔案匯入
| 功能 | 描述 | 優先級 |
|------|------|--------|
| Excel 匯入 | 支援 `.xlsx`, `.xls` 格式 | P0 |
| CSV 匯入 | 支援 `.csv` 格式，自動偵測編碼 | P0 |
| 拖放上傳 | 支援 Drag & Drop 上傳檔案 | P1 |
| 欄位自動對應 | 智慧辨識「姓名」「房號」「備註」等欄位 | P1 |

#### 3.1.2 智慧判斷功能
| 功能 | 描述 | 優先級 |
|------|------|--------|
| 素食桌判斷 | 依備註欄位自動標記素食者 | P1 |
| 自動分車 | 依規則自動分配車次 | P1 |
| 預設值可覆寫 | 所有自動判斷結果皆可手動修改 | P0 |

#### 3.1.3 線上資料表 (Web Grid)
| 功能 | 描述 | 優先級 |
|------|------|--------|
| 類 Excel 介面 | 匯入後顯示可編輯的表格 | P0 |
| 即時編輯 | 直接修改姓名、房號、備註等欄位 | P0 |
| 新增/刪除列 | 可手動新增或刪除人員 | P0 |
| 排序功能 | 依任意欄位排序 | P2 |
| 篩選功能 | 依條件篩選顯示 | P2 |

---

### 3.2 第二區：版型與全域文字設定 (Template Editor)

#### 3.2.1 可編輯標題區
| 欄位 | 預設值範例 | 說明 |
|------|------------|------|
| 主標題 | 台灣通力電梯 | 公司/組織名稱 |
| 副標題 | 親清日月潭山系 | 活動名稱 |

#### 3.2.2 可編輯標籤 (Labels)
| 標籤 | 預設值 | 可改為範例 |
|------|--------|------------|
| 桌號標籤 | `★ 桌 號：` | `Table:`, `座位：` |
| 房號標籤 | `★ 房 號：` | `組 別：`, `Room:` |

#### 3.2.3 底部資訊 (Footer)
| 功能 | 描述 |
|------|------|
| 預設內容 | `A車 領隊 黃啟翔...` |
| 完全自訂 | 可改為活動 Slogan、Wifi 密碼、聯絡資訊等 |
| 多行支援 | 支援輸入多行文字 |

#### 3.2.4 全域樣式
| 項目 | 功能 |
|------|------|
| 預設字體大小 | 設定所有名牌的基準字級 |
| 預設字型 | 選擇字型家族 |
| 版型佈局 | 選擇名牌排列方式 |

---

### 3.3 第三區：個別名牌微調 (Individual Override)

#### 3.3.1 點擊編輯模式
| 功能 | 描述 | 優先級 |
|------|------|--------|
| 點擊選取 | 在預覽畫面中點擊單張名牌進入編輯 | P0 |
| 獨立字體調整 | 單獨調整該名牌的字體大小 | P0 |
| 獨立背景色 | 單獨設定底色（如壽星用金色） | P0 |
| 獨立文字修改 | 修改該人的桌號敘述等資訊 | P0 |
| 隔離變更 | 修改只影響該名牌，不影響其他人 | P0 |

#### 3.3.2 特殊標記
| 功能 | 描述 |
|------|------|
| 素食標記 | 可手動改為「不吃牛」「蛋奶素」等 |
| VIP 標記 | 特殊人員標註 |
| 備註欄 | 額外資訊顯示 |

---

### 3.4 第四區：樣式與顏色控制 (Style & Color)

#### 3.4.1 自訂色票
| 功能 | 描述 | 優先級 |
|------|------|--------|
| Color Picker | 視覺化顏色選擇器 | P0 |
| 文字顏色 | 自訂名牌文字顏色 | P0 |
| 分隔線顏色 | 自訂分隔線顏色 | P1 |
| 背景底色 | 自訂名牌背景色 | P0 |
| 預設色票 | 提供常用配色快速選擇 | P1 |

#### 3.4.2 快速配色功能
| 功能 | 描述 |
|------|------|
| 依車種變色 | 按鈕一鍵，不同車次自動套用不同顏色 |
| 隨機變色 | 按鈕一鍵，隨機分配顏色 |
| 重置樣式 | 還原為預設配色 |

---

### 3.5 名牌尺寸設定

#### 3.5.1 預設尺寸
| 尺寸名稱 | 規格 | 說明 |
|----------|------|------|
| 滿版 A4 | 210 × 297 mm | 一張名牌佔滿整張 A4 |
| 標準桌牌 | 100 × 60 mm | 常見桌上名牌尺寸 |
| 大型名牌 | 148 × 105 mm | A6 尺寸 |

#### 3.5.2 自訂尺寸
| 功能 | 描述 |
|------|------|
| 寬度輸入 | 使用者可輸入自訂寬度 (mm) |
| 高度輸入 | 使用者可輸入自訂高度 (mm) |
| 即時預覽 | 調整尺寸後即時更新預覽 |

---

### 3.6 使用者系統

#### 3.6.1 登入功能
| 功能 | 描述 | 優先級 |
|------|------|--------|
| 帳號註冊 | Email 註冊新帳號 | P0 |
| 登入驗證 | Email + 密碼登入 | P0 |
| 記住登入 | 可選擇保持登入狀態 | P1 |
| 忘記密碼 | 密碼重設功能 | P1 |

#### 3.6.2 資料儲存
| 功能 | 描述 |
|------|------|
| 專案儲存 | 登入後可儲存當前編輯狀態 |
| 歷史專案 | 查看並載入過去儲存的專案 |
| 範本儲存 | 將版型設定存為可重複使用的範本 |

> **技術備註**：使用 LocalStorage 或 IndexedDB 實作純前端儲存，搭配 Base64 編碼實現「匯出/匯入專案檔」功能模擬雲端儲存體驗。

---

### 3.7 輸出功能

#### 3.7.1 輸出格式
| 格式 | 描述 | 優先級 |
|------|------|--------|
| PDF | 高品質向量輸出，保留所有樣式 | P0 |
| Word (.docx) | 可編輯的 Word 文件 | P0 |
| 直接列印 | 網頁直接觸發列印對話框 | P0 |

#### 3.7.2 輸出設定
| 設定 | 描述 |
|------|------|
| 紙張大小 | A4 / Letter / 自訂 |
| 方向 | 直向 / 橫向 |
| 每頁數量 | 設定每頁放置幾張名牌 |
| 邊界設定 | 自訂頁面邊界 |
| 裁切線 | 可選是否顯示裁切線 |

---

## 4. 技術規格

### 4.1 技術架構
| 項目 | 技術選擇 |
|------|----------|
| 前端框架 | 純 HTML5 + CSS3 + Vanilla JavaScript |
| 檔案解析 | SheetJS (xlsx.js) - Excel/CSV 解析 |
| PDF 生成 | jsPDF + html2canvas |
| Word 生成 | docx.js |
| 資料儲存 | LocalStorage / IndexedDB |
| 部署環境 | GitHub Pages / 任意靜態託管 |

### 4.2 瀏覽器支援
| 瀏覽器 | 最低版本 |
|--------|----------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

### 4.3 效能需求
| 指標 | 目標 |
|------|------|
| 首次載入 | < 3 秒 |
| 匯入 100 筆資料 | < 2 秒 |
| 預覽更新延遲 | < 100 ms |
| PDF 生成 (50 張) | < 10 秒 |

---

## 5. 頁面結構

```
┌─────────────────────────────────────────────────────────────────┐
│  Header: Logo + 專案名稱 + 使用者選單                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐  ┌─────────────────────────────────────┐  │
│  │                 │  │                                     │  │
│  │   控制面板區     │  │         名牌預覽區                   │  │
│  │   (左側欄)      │  │         (主視覺區)                   │  │
│  │                 │  │                                     │  │
│  │  ┌───────────┐  │  │   ┌───────┐  ┌───────┐  ┌───────┐  │  │
│  │  │ 資料匯入  │  │  │   │ 名牌1 │  │ 名牌2 │  │ 名牌3 │  │  │
│  │  └───────────┘  │  │   └───────┘  └───────┘  └───────┘  │  │
│  │  ┌───────────┐  │  │   ┌───────┐  ┌───────┐  ┌───────┐  │  │
│  │  │ 版型設定  │  │  │   │ 名牌4 │  │ 名牌5 │  │ 名牌6 │  │  │
│  │  └───────────┘  │  │   └───────┘  └───────┘  └───────┘  │  │
│  │  ┌───────────┐  │  │                                     │  │
│  │  │ 樣式控制  │  │  │                                     │  │
│  │  └───────────┘  │  │                                     │  │
│  │  ┌───────────┐  │  │                                     │  │
│  │  │ 輸出選項  │  │  │                                     │  │
│  │  └───────────┘  │  │                                     │  │
│  │                 │  │                                     │  │
│  └─────────────────┘  └─────────────────────────────────────┘  │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  Footer: 版權資訊 + 說明連結                                      │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 使用流程

```
┌──────────────┐
│   開啟網站    │
└──────┬───────┘
       │
       ▼
┌──────────────┐     ┌──────────────┐
│  登入/註冊   │────▶│  載入歷史專案 │
└──────┬───────┘     └──────────────┘
       │
       ▼
┌──────────────┐
│ 1. 匯入檔案  │  ◀── Excel / CSV
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 2. 資料確認  │  ◀── Web Grid 編輯
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 3. 全域設定  │  ◀── 標題、標籤、Footer
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 4. 個別微調  │  ◀── 點擊單張名牌修改
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 5. 樣式調整  │  ◀── 顏色、配色
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ 6. 預覽確認  │
└──────┬───────┘
       │
       ▼
┌──────────────────────────────────┐
│            7. 輸出               │
├──────────┬──────────┬────────────┤
│   PDF    │   Word   │   列印     │
└──────────┴──────────┴────────────┘
```

---

## 7. 名牌版型結構

```
┌─────────────────────────────────────────┐
│           [主標題區 - 可編輯]            │
│          台灣通力電梯                    │
├─────────────────────────────────────────┤
│           [副標題區 - 可編輯]            │
│         親清日月潭山系                   │
├─────────────────────────────────────────┤
│                                         │
│              [姓名區]                    │
│              王 小 明                    │
│                                         │
├─────────────────────────────────────────┤
│  [標籤可編輯] ★ 桌 號：  12              │
├─────────────────────────────────────────┤
│  [標籤可編輯] ★ 房 號：  501             │
├─────────────────────────────────────────┤
│           [備註區 - 可選]                │
│              素食                       │
├─────────────────────────────────────────┤
│           [Footer - 可編輯]              │
│     A車 領隊 黃啟翔 0912-345-678         │
└─────────────────────────────────────────┘
```

---

## 8. 資料結構

### 8.1 人員資料 (Person)
```javascript
{
  id: "uuid",
  name: "王小明",
  table: "12",
  room: "501",
  note: "素食",
  bus: "A",
  // 個別覆寫設定
  override: {
    fontSize: null,      // 覆寫字體大小
    bgColor: null,       // 覆寫背景色
    textColor: null,     // 覆寫文字色
    customNote: null     // 覆寫備註文字
  }
}
```

### 8.2 全域設定 (GlobalConfig)
```javascript
{
  title: {
    main: "台灣通力電梯",
    sub: "親清日月潭山系"
  },
  labels: {
    table: "★ 桌 號：",
    room: "★ 房 號："
  },
  footer: "A車 領隊 黃啟翔 0912-345-678",
  style: {
    fontSize: 16,
    fontFamily: "Noto Sans TC",
    textColor: "#333333",
    bgColor: "#ffffff",
    borderColor: "#cccccc"
  },
  size: {
    width: 100,   // mm
    height: 60,   // mm
    preset: "standard"  // "a4-full", "standard", "large", "custom"
  }
}
```

### 8.3 專案資料 (Project)
```javascript
{
  id: "uuid",
  name: "2026日月潭活動",
  createdAt: "2026-01-21T10:00:00Z",
  updatedAt: "2026-01-21T15:30:00Z",
  globalConfig: { ... },
  persons: [ ... ]
}
```

---

## 9. 開發里程碑

### Phase 1：核心功能 (MVP)
- [ ] 專案基礎架構搭建
- [ ] 深色主題 UI 框架
- [ ] Excel/CSV 檔案匯入
- [ ] Web Grid 資料編輯
- [ ] 基本名牌預覽
- [ ] 全域文字設定
- [ ] PDF 輸出

### Phase 2：進階編輯
- [ ] 個別名牌點擊編輯
- [ ] 樣式覆寫功能
- [ ] Color Picker 整合
- [ ] 快速配色功能
- [ ] Word 輸出
- [ ] 直接列印功能

### Phase 3：使用者系統
- [ ] 登入/註冊功能
- [ ] 專案儲存與載入
- [ ] 範本系統
- [ ] 匯出/匯入專案檔

### Phase 4：優化與擴充
- [ ] 效能優化
- [ ] 更多尺寸預設
- [ ] 進階排版選項
- [ ] 鍵盤快捷鍵支援

---

## 10. 附錄

### 10.1 名詞定義
| 名詞 | 定義 |
|------|------|
| 全域設定 | 套用到所有名牌的設定 |
| 個別覆寫 | 只套用到單一名牌的特殊設定 |
| 版型 | 名牌的整體結構與排版 |
| 預設值 | 系統自動判斷產生的初始值 |

### 10.2 參考資源
- [SheetJS 官方文件](https://sheetjs.com/)
- [jsPDF 官方文件](https://github.com/parallax/jsPDF)
- [docx.js 官方文件](https://github.com/dolanmiu/docx)

---

*文件結束*
